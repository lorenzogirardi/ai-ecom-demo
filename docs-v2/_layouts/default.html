<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <link rel="canonical" href="{{ page.url | absolute_url }}">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Convert code blocks to mermaid divs
            document.querySelectorAll('pre code.language-mermaid, pre > code').forEach(function(codeBlock) {
                const content = codeBlock.textContent;
                if (content.trim().startsWith('flowchart') ||
                    content.trim().startsWith('graph') ||
                    content.trim().startsWith('sequenceDiagram') ||
                    content.trim().startsWith('classDiagram') ||
                    content.trim().startsWith('stateDiagram') ||
                    content.trim().startsWith('erDiagram') ||
                    content.trim().startsWith('journey') ||
                    content.trim().startsWith('gantt') ||
                    content.trim().startsWith('pie') ||
                    content.trim().startsWith('mindmap') ||
                    content.trim().startsWith('timeline') ||
                    content.trim().startsWith('gitGraph') ||
                    content.trim().startsWith('C4') ||
                    content.trim().startsWith('subgraph')) {
                    const pre = codeBlock.parentElement;
                    const div = document.createElement('div');
                    div.className = 'mermaid';
                    div.textContent = content;
                    pre.parentNode.replaceChild(div, pre);
                }
            });

            // Initialize mermaid
            mermaid.initialize({
                startOnLoad: true,
                theme: 'dark',
                themeVariables: {
                    primaryColor: '#58a6ff',
                    primaryTextColor: '#e6edf3',
                    primaryBorderColor: '#30363d',
                    lineColor: '#8b949e',
                    secondaryColor: '#161b22',
                    tertiaryColor: '#21262d',
                    background: '#0d1117',
                    fontFamily: 'Inter, sans-serif'
                },
                flowchart: {
                    useMaxWidth: true,
                    htmlLabels: true
                },
                sequence: {
                    useMaxWidth: true
                }
            });

            // Re-run mermaid
            mermaid.run();
        });
    </script>

    <!-- Feed -->
    <link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ '/feed.xml' | relative_url }}">
</head>
<body>
    <header class="site-header">
        <div class="container">
            <nav class="nav">
                <a href="{{ '/' | relative_url }}" class="logo">
                    <span class="logo-icon">DOC</span>
                    <span class="logo-text">{{ site.title }}</span>
                </a>
                <ul class="nav-links">
                    <li><a href="{{ '/' | relative_url }}">Home</a></li>
                    <li><a href="{{ '/sessions/' | relative_url }}">Sessions</a></li>
                    <li><a href="{{ '/architecture/' | relative_url }}">Architecture</a></li>
                    <li><a href="{{ '/technical/' | relative_url }}">Technical</a></li>
                    <li><a href="https://github.com/lorenzogirardi/ai-ecom-demo" target="_blank">GitHub</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-content">
        {{ content }}
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <p>&copy; 2026 {{ site.author }}. Built with Claude Code in 10 days.</p>
                <p class="footer-links">
                    <a href="https://github.com/lorenzogirardi/ai-ecom-demo">Repository</a> |
                    <a href="https://dls03qes9fc77.cloudfront.net">Live Demo</a> |
                    <a href="https://youtu.be/tNtAPNx70bc">YouTube Session</a>
                </p>
            </div>
        </div>
    </footer>
    <!-- Lightbox for images -->
    <div class="lightbox-overlay" id="lightbox">
        <span class="lightbox-close">&times;</span>
        <img src="" alt="Full size image" id="lightbox-img">
    </div>

    <script>
        (function() {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');

            // Add click handler to all post images
            document.querySelectorAll('.post-content img').forEach(function(img) {
                img.addEventListener('click', function(e) {
                    e.preventDefault();
                    lightboxImg.src = this.src;
                    lightbox.classList.add('active');
                    document.body.style.overflow = 'hidden';
                });
            });

            // Close lightbox on click
            lightbox.addEventListener('click', function() {
                lightbox.classList.remove('active');
                document.body.style.overflow = '';
            });

            // Close on Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && lightbox.classList.contains('active')) {
                    lightbox.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });
        })();
    </script>
</body>
</html>
